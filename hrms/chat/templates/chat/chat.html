<!DOCTYPE html>
<html>
<head>
    <title>Chat Room</title>
</head>
<body>
    <h2>Welcome to the Chat Room</h2>

    <div id="chat-log" style="border:1px solid #000; height:200px; overflow:auto;"></div><br>

    <input id="chat-message-input" type="text" placeholder="Type a message...">
    <button id="chat-message-send">Send</button>

    <script>
const chatSocket = new WebSocket(
    'ws://' + window.location.host + '/ws/chat/'
);

chatSocket.onmessage = function(e) {
    const data = JSON.parse(e.data);
    const chatLog = document.getElementById('chat-log');
    chatLog.value += data.username + ': ' + data.message + '\n';
};

document.getElementById('chat-form').onsubmit = function(e) {
    e.preventDefault();
    const messageInput = document.getElementById('chat-message-input');
    const message = messageInput.value;
    const username = "{{ request.user.username }}"; // or replace manually

    chatSocket.send(JSON.stringify({
        'message': message,
        'username': username
    }));

    messageInput.value = '';
};
</script>

</body>
</html>
